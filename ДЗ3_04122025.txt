@startuml
start

:Клиент регистрируется или входит в аккаунт;
:Система подтверждает учётные данные;
:Клиент выбирает товары в корзину;
:Клиент оформляет заказ, выбирает доставку и оплату;

fork
  :Система проверяет наличие товара на складе;
  if (Товар доступен?) then (да)
    :Товар зарезервирован;
  else (нет)
    :Уведомление клиента о недоступности;
    :Клиент выбирает альтернативу или удаляет товар;
  endif
fork again
  :Клиент выбирает способ оплаты;
  :Система проверяет детали и проводит транзакцию;
  if (Оплата успешна?) then (да)
    :Оплата подтверждена;
  else (нет)
    :Уведомление о проблеме с платежом;
    :Предложение повторить оплату или изменить способ;
    if (Клиент устранил проблему?) then (да)
      :Оплата подтверждена;
    else (нет)
      :Заказ отменяется;
      :Возврат средств (если списаны);
      stop
    endif
  endif
fork again
  :Система уведомляет склад о сборе;
  :Сотрудники склада комплектуют заказ;
  :Товар готов к отправке;
end fork

  :Генерация счёт-фактуры;
  :Отправка уведомления клиенту;
  :Заказ переходит в статус «Отправлен»;

  :Система обновляет статус заказа (в пути, доставка);
  :Клиент получает уведомления об изменении статуса;
  stop

@enduml